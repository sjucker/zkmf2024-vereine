<div>
  <app-header header="ZKMF2024 - Vereinsbereich"></app-header>
  <div class="loading-indicator">
    <mat-progress-bar mode="indeterminate" color="accent"
                      *ngIf="showProgressBar()"></mat-progress-bar>
  </div>

  <div class="container">
    <div class="info-container">
      Bitte ein Gerät mit einer höheren Auflösung verwenden.
    </div>

    <h2>Bühnenplan</h2>

    <div class="actions-container">
      <button mat-stroked-button
              (click)="navigateBack()">zurück
      </button>

      <app-action-button buttonLabel="Speichern"
                         [processing]="saving()"
                         (buttonClicked)="save()"></app-action-button>

      <a [href]="percussionListUrl" target="_blank">Perkussionsmaterial (PDF)</a>
    </div>

    <div class="stage-canvas-container">
      <canvas [id]="canvasId"></canvas>
    </div>

    <div class="max-width-container">
      <div class="form-layout">
        <mat-checkbox [(ngModel)]="stageSetup.dirigentenpodest"
                      (ngModelChange)="onChange()">Dirigentenpodest benötigt
        </mat-checkbox>

        <mat-form-field appearance="outline">
          <mat-label>Anzahl Schlägelablagen (max. 5)</mat-label>
          <input type="number"
                 autocomplete="off"
                 matInput
                 [(ngModel)]="stageSetup.ablagenAmount"
                 (ngModelChange)="onChange()"
                 min="0"
                 max="5">
        </mat-form-field>
        <div style="flex: 3;"></div>
      </div>

      <mat-form-field appearance="outline" color="primary">
        <mat-label>Erläuterungen zum Bühnenplan</mat-label>
        <textarea matInput
                  cdkTextareaAutosize
                  cdkAutosizeMinRows="3"
                  cdkAutosizeMaxRows="15"
                  maxlength="4096"
                  [(ngModel)]="stageSetup.comment"
                  (ngModelChange)="onChange()"></textarea>
      </mat-form-field>
    </div>

    <div class="max-width-container">
      <h3>Zusätzliche Bühnenplan-Skizze</h3>
      @if (stageSetup.hasAdditionalImage) {
        <p class="actions-container">
          <button mat-flat-button color="primary" (click)="deleteAdditionalImage()">bestehende Bühnenplan-Skizze löschen</button>
          <button mat-stroked-button color="primary" (click)="downloadAdditionalImage()">Bühnenplan-Skizze herunterladen</button>
        </p>
      } @else {
        <p>Falls ihr nicht alles auf dem Bühnenplan abbilden könnt, könnt ihr hier eine Skizze hochladen (jpg, max. 4 MB, am besten im Querformat).</p>
        <ngx-dropzone (change)="onDrop($event)"
                      [multiple]="false"
                      accept="image/jpeg,image/jpg"
                      [maxFileSize]="maxFileSize"
                      [disabled]="uploading()">
          <ngx-dropzone-label>Zusätzliches Bild (max. 4 MB, Querformat)<br/>(Drag-and-Drop oder hier klicken)</ngx-dropzone-label>
        </ngx-dropzone>
      }
    </div>

    <div class="max-width-container">
      <div class="help-container">
        <h3>Informationen</h3>
        <ul>
          <li>Ziehe die Instrumente auf die blauen Bühnenelemente, um sie zu platzieren. Um ein Instrument zu entfernen, ziehe es auf das Abfallsymbol.</li>
          <li>Die Anzahl der benötigten Stühle muss pro Sitzreihe eingegeben werden.</li>
          <li>Dies ist eine schematische Darstellung zur Vorbereitung der Bühne. Die genaue Platzierung der Instrumente/Stühle/Notenständer obliegt dem Verein.</li>
          <li>Kleinpercussionsinstrumente wie Sleight Bells, Tambourin ohne Fell, Finger Cymbals, Tambourin oder Triangel,
            die nicht auf der Liste aufgeführt sind, sowie sämtliches Schlägelmaterial, müssen von den teilnehmenden
            Vereinen selbst mitgebracht werden.
          </li>
          <li>Fragen zu den Instrumenten beantwortet Ihnen Emil Bolli (<a href="mailto:emil.bolli@murbach-musik.ch">emil.bolli&#64;murbach-musik.ch</a>) gerne persönlich.</li>
        </ul>
      </div>
    </div>
  </div>
</div>
